# 代码补全服务器部署指南

## 项目概述
基于Django的代码补全API服务器，为VSCode智能编码助手插件提供后端服务。

## 系统要求
- Python 3.14.1+
- Pixi 包管理器
- DeepSeek API密钥

## 快速开始

### 1. 安装依赖
```bash
pixi install
export DEEPSEEK_API_KEY="your-api-key"
```

### 2. 初始化数据库
```bash
pixi run python manage.py migrate
```

### 3. 启动服务
```bash
pixi run python manage.py runserver
```

### 4. 验证
```bash
pixi run python test_api.py
```

## 生产部署

### 环境变量
```bash
DEEPSEEK_API_KEY=your-api-key
DEBUG=False
SECRET_KEY=your-secret-key
ALLOWED_HOSTS=your-domain.com
```

### Gunicorn
```bash
pixi add --pypi gunicorn
pixi run gunicorn api.wsgi:application --bind 0.0.0.0:8000 --workers 4
```

### Nginx 反向代理
```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## 常见问题

### 服务无法启动
```bash
pixi run python manage.py check
```

### API 返回错误
```bash
# 检查 API 密钥
echo $DEEPSEEK_API_KEY

# 查看日志
tail -f /var/log/codegen-server/error.log
```

### Nginx 502 错误
```bash
# 检查 Gunicorn 状态
sudo systemctl status codegen-server

# 测试直接连接
curl http://127.0.0.1:8000/api/v1/completion
```

## 相关文档
- [AGENTS.md](./AGENTS.md) - 开发指南
- [API文档.md](./API文档.md) - API 规范

---
*最后更新: 2026-02-22*
